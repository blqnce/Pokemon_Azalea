{
  "initializationAction": [
    "(q.npc.is_in_battle_with(q.player) || !q.npc.is_doing_activity('minecraft:idle', 'cobblemon:battling')) ? q.dialogue.close();",
    "v.has_met = (q.player.data.brock_defeated >= 1) ? 'defeated' : ((q.player.data.brock_interacted >= 1) ? 'met' : 'unmet');",
    "(q.player.data.gt_rock_defeated <= 1) ? q.dialogue.set_page('req-unmet');"
  ],
  "speakers": {
    "npc": {
      "name": {
        "type": "expression",
        "expression": "q.npc.name"
      },
      "face": "q.npc.face(false);"
    },
    "player": {
      "face": "q.player.face();",
      "name": {
        "type": "expression",
        "expression": "q.player.username"
      }
    }
  },
  "pages": [
    {
      "id": "player-chat",
      "speaker": "player",
      "lines": [
        {
          "type": "expression",
          "expression": "'Hello, I\\'m ' + q.player.username + '!'"
        }
      ],
      "input": [
        "q.dialogue.set_page(v.has_met);",
        "q.player.data.brock_interacted = 1;",
        "q.player.save_data();"
      ]
    },
    {
      "id": "unmet",
      "speaker": "npc",
      "lines": [
        {
          "type": "expression",
          "expression": "'Hello, ' + q.player.username + '! You may have heard of me before, I\\'m ' + q.npc.name + '!'"
        }
      ],
      "input": {
        "type": "option",
        "vertical": false,
        "options": [
          {
            "text": {
              "type": "expression",
              "expression": "q.run_script('cobblemon:npc_battle_cooling_down') ? '(On Cooldown)' : 'Challenge';"
            },
            "value": "battle",
            "action": [
              "q.dialogue.set_page('battle')"
            ],
            "isSelectable": "!q.run_script('cobblemon:npc_battle_cooling_down') && c.npc.can_battle;"
          },
          {
            "text": "Debug",
            "value": "Debug",
            "action": [
              "q.dialogue.set_page('debug')"
            ]
          },
          {
            "text": "Cancel",
            "value": "cancel",
            "action": [
              "q.dialogue.set_page('farewell')"
            ]
          }
        ]
      }
    },
    {
      "id": "met",
      "speaker": "npc",
      "lines": [
        {
          "type": "expression",
          "expression": "'Hello, ' + q.player.username + '! I see you\\'re back to face the one and only ' + q.npc.name + '!'"
        }
      ],
      "input": {
        "type": "option",
        "vertical": false,
        "options": [
          {
            "text": {
              "type": "expression",
              "expression": "q.run_script('cobblemon:npc_battle_cooling_down') ? '(On Cooldown)' : 'Challenge';"
            },
            "value": "battle",
            "action": [
              "q.dialogue.set_page('battle')"
            ],
            "isSelectable": "!q.run_script('cobblemon:npc_battle_cooling_down') && c.npc.can_battle;"
          },
          {
            "text": "Debug",
            "value": "Debug",
            "action": [
              "q.dialogue.set_page('debug')"
            ]
          },
          {
            "text": "Cancel",
            "value": "cancel",
            "action": [
              "q.dialogue.set_page('farewell')"
            ]
          }
        ]
      }
    },
    {
      "id": "defeated",
      "speaker": "npc",
      "lines": [
        {
          "type": "expression",
          "expression": "'It is great to see you again, ' + q.player.username + '! Are you back for another amazing battle?'"
        }
      ],
      "input": {
        "type": "option",
        "vertical": false,
        "options": [
          {
            "text": {
              "type": "expression",
              "expression": "q.run_script('cobblemon:npc_battle_cooling_down') ? '(On Cooldown)' : 'Challenge';"
            },
            "value": "battle",
            "action": [
              "q.dialogue.set_page('battle')"
            ],
            "isSelectable": "!q.run_script('cobblemon:npc_battle_cooling_down') && c.npc.can_battle;"
          },
          {
            "text": "Debug",
            "value": "Debug",
            "action": [
              "q.dialogue.set_page('debug')"
            ]
          },
          {
            "text": "Cancel",
            "value": "cancel",
            "action": [
              "q.dialogue.set_page('farewell')"
            ]
          }
        ]
      }
    },
    {
      "id": "farewell",
      "speaker": "npc",
      "lines": ["Just know that I'll always be here, ready to battle!"],
      "input": "q.dialogue.close();"
    },
    {
      "id": "battle",
      "speaker": "npc",
      "lines": ["Here's to a good match!"],
      "input": [
        "q.dialogue.close();",
        "q.npc.start_battle(q.player);"
      ]
    },
    {
      "id": "req-unmet",
      "speaker": "npc",
      "lines": ["You just walked past my gym trainers! Defeat them first, it's good practice."],
      "input": "q.dialogue.close();"
    },
    {
      "id": "debug",
      "speaker": "npc",
      "lines": [
        {
          "type": "expression",
          "expression": "'Debug Menu'"
        }
      ],
      "input": {
        "type": "option",
        "vertical": false,
        "options": [
          {
            "text": "zero",
            "value": "zero",
            "action": [
              "q.player.data.brock_defeated = 0; q.player.save_data()"
            ]
          },
          {
            "text": "one",
            "value": "one",
            "action": [
              "q.player.data.brock_defeated = 1; q.player.save_data()"
            ]
          },
          {
            "text": "two",
            "value": "two",
            "action": [
              "q.player.data.brock_defeated = 2; q.player.save_data()"
            ]
          },
          {
            "text": "three",
            "value": "three",
            "action": [
              "q.player.data.brock_defeated = 3; q.player.save_data()"
            ]
          },
          {
            "text": "four",
            "value": "four",
            "action": [
              "q.player.data.brock_defeated = 4; q.player.save_data()"
            ]
          },
          {
            "text": "five",
            "value": "five",
            "action": [
              "q.player.data.brock_defeated = 5; q.player.save_data()"
            ]
          },
          {
            "text": "six",
            "value": "six",
            "action": [
              "q.player.data.brock_defeated = 6; q.player.save_data()"
            ]
          },
          {
            "text": "seven",
            "value": "seven",
            "action": [
              "q.player.data.brock_defeated = 7; q.player.save_data()"
            ]
          },
          {
            "text": "Back",
            "value": "back",
            "action": [
              "q.dialogue.set_page('npc-chat')"
            ]
          }
        ]
      }
    }
  ]
}